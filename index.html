<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="img/fav.png" sizes="32x32" />
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">	
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/navigation.css">
	<title>Conan Scrolls - Home</title>
</head>
<body>
		<script>
				function openNav() {
				  document.getElementById("mySidenav").style.width = "250px";
				  document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
				}
				
				function closeNav() {
				  document.getElementById("mySidenav").style.width = "0";
				  document.getElementById("main").style.marginLeft= "0";
				  document.body.style.backgroundColor = "white";
				}
		</script>
		<span style="font-size:30px;cursor:pointer;color:white" onclick="openNav()">&#9776; Menu</span>
		<div id="mySidenav" class="sidenav">
				<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
				<a href="index.html">Home</a>
				<a href="item.html">Items</a>
				<a href="recipe.html">Recipes</a>
				<a href="feats.html">Feats</a>
				<a href="#"><s>Spells/Debuffs</s></a>
		</div>
	<header>
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h2 class="text-center"><a href="index.html"><img src="img/conanscrolls.png" width="10%"></a></h2>
					<form>
					  <div class="form-group">
					    <input type="text" name="search" id="search" class="form-control" placeholder="Search Items..." autocomplete="off">
						<ul class="list-group" id="result"></ul>
					  </div>
					</form>
				</div>
			</div>
		</div>
	</header>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="js/handlebars-v4.1.1.js"></script>
	<script src="js/item.js" type="text/javascript"></script>
	<script>

		(function(){

			function clearResults(){
				$('#result').css('display', 'none').html('');
			}

			$.ajaxSetup({ cache: false });

			$('#search').keyup(function(){
				if( this.value.length < 3 ) {
					clearResults();
					return;
				}
				clearResults();
				var searchField = $('#search').val();
				RegExp.quote = function(str) {
					return str.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1");
				};
				var expression = new RegExp(RegExp.quote(searchField), "i");
				$.getJSON('data.json', function(data) {
					$.each(data, function(key, value){
						if (value.Name.search(expression) != -1) {
							$('#result').css('display', 'block').append('<li class="list-group-item" data-id="'+value.RowName+'"><img src="'+value.Icon+'" height="64" width="64" class="img-thumbnail" /><h4>'+value.Name+'</h4><span class="text-muted">'+value.ShortDesc+'</span></li>');
						}
					});   
				});
			});
			
		})();
		
		var urlParams = new URLSearchParams(window.location.search);
		var searchId = urlParams.get("search");

			if(searchId) {
				RegExp.quote = function(str) {
					return str.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1");
				};
			var expression = new RegExp(RegExp.quote(searchId), "i");

				$.getJSON('data.json', function(data) {
					$.each(data, function(key, value){
						if (value.Name.search(expression) != -1) {
							$('#result').css('display', 'block').append('<li class="list-group-item" data-id="'+value.RowName+'"><img src="'+value.Icon+'" height="32" width="32" class="img-thumbnail" /><h4>'+value.Name+'</h4><span class="text-muted">'+value.ShortDesc+'</span></li>');
						}
					});
				});
			}
	</script>

</body>
</html>
